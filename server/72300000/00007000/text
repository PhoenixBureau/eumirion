http://homepages.inf.ed.ac.uk/wadler/papers/dual-reloaded/dual-reloaded.pdf